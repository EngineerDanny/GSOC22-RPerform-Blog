<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Updating the dependencies used in Rperform and fix related issues. | GSOC22-RPerform-Blog</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Updating the dependencies used in Rperform and fix related issues." />
<meta property="og:locale" content="en_US" />
<meta name="description" content="This is the total review of how I went about in fixing the issues with dependencies in Rperform package." />
<meta property="og:description" content="This is the total review of how I went about in fixing the issues with dependencies in Rperform package." />
<link rel="canonical" href="https://engineerdanny.github.io/GSOC22-RPerform-Blog/rperform/performance/test/r/git/github/2022/06/20/Updating-dependencies-In-Rperform.html" />
<meta property="og:url" content="https://engineerdanny.github.io/GSOC22-RPerform-Blog/rperform/performance/test/r/git/github/2022/06/20/Updating-dependencies-In-Rperform.html" />
<meta property="og:site_name" content="GSOC22-RPerform-Blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-06-20T00:00:00-05:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Updating the dependencies used in Rperform and fix related issues." />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-06-20T00:00:00-05:00","datePublished":"2022-06-20T00:00:00-05:00","description":"This is the total review of how I went about in fixing the issues with dependencies in Rperform package.","headline":"Updating the dependencies used in Rperform and fix related issues.","mainEntityOfPage":{"@type":"WebPage","@id":"https://engineerdanny.github.io/GSOC22-RPerform-Blog/rperform/performance/test/r/git/github/2022/06/20/Updating-dependencies-In-Rperform.html"},"url":"https://engineerdanny.github.io/GSOC22-RPerform-Blog/rperform/performance/test/r/git/github/2022/06/20/Updating-dependencies-In-Rperform.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/GSOC22-RPerform-Blog/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://engineerdanny.github.io/GSOC22-RPerform-Blog/feed.xml" title="GSOC22-RPerform-Blog" /><link rel="shortcut icon" type="image/x-icon" href="/GSOC22-RPerform-Blog/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />

<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/GSOC22-RPerform-Blog/">GSOC22-RPerform-Blog</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/GSOC22-RPerform-Blog/search/">Search</a><a class="page-link" href="/GSOC22-RPerform-Blog/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Updating the dependencies used in Rperform and fix related issues.</h1><p class="page-description">This is the total review of how I went about in fixing the issues with dependencies in Rperform package.</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2022-06-20T00:00:00-05:00" itemprop="datePublished">
        Jun 20, 2022
      </time>
       • <span class="read-time" title="Estimated read time">
    
    
      5 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/GSOC22-RPerform-Blog/categories/#Rperform">Rperform</a>
        &nbsp;
      
        <a class="category-tags-link" href="/GSOC22-RPerform-Blog/categories/#performance">performance</a>
        &nbsp;
      
        <a class="category-tags-link" href="/GSOC22-RPerform-Blog/categories/#test">test</a>
        &nbsp;
      
        <a class="category-tags-link" href="/GSOC22-RPerform-Blog/categories/#r">r</a>
        &nbsp;
      
        <a class="category-tags-link" href="/GSOC22-RPerform-Blog/categories/#git">git</a>
        &nbsp;
      
        <a class="category-tags-link" href="/GSOC22-RPerform-Blog/categories/#github">github</a>
        
      
      </p>
    

    </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul id="toc" class="section-nav">
<li class="toc-entry toc-h1"><a href="#introduction">Introduction</a>
<ul>
<li class="toc-entry toc-h2"><a href="#the-git2r-package">The git2r package</a></li>
<li class="toc-entry toc-h2"><a href="#the-animint-dependency">The Animint dependency</a></li>
<li class="toc-entry toc-h2"><a href="#fix-dependency-and-related-issues">Fix dependency and related issues</a></li>
</ul>
</li>
<li class="toc-entry toc-h1"><a href="#conclusion">Conclusion</a></li>
</ul><h1 id="introduction">
<a class="anchor" href="#introduction" aria-hidden="true"><span class="octicon octicon-link"></span></a>Introduction</h1>
<p>In R, it is the main purpose of the <code class="language-plaintext highlighter-rouge">DESCRIPTION</code> file to convey the metadata about a package. It is also needed to list all the dependencies that the package uses. Inside the <code class="language-plaintext highlighter-rouge">DESCRIPTION</code> file, there are <code class="language-plaintext highlighter-rouge">Imports</code> and <code class="language-plaintext highlighter-rouge">Suggests</code> section under which, you can list your dependencies. There is a minor difference between the two. The packages under <code class="language-plaintext highlighter-rouge">Imports</code> are needed by your users at runtime. <code class="language-plaintext highlighter-rouge">Packages</code> under <code class="language-plaintext highlighter-rouge">Suggests</code> however, may be optional because it is either used for development or optional functionalities. There was a major issue with the major dependencies used by <code class="language-plaintext highlighter-rouge">Rperform</code>. The issue was that, the versions of the dependencies used were too old and one of the them was discontinued.</p>

<h2 id="the-git2r-package">
<a class="anchor" href="#the-git2r-package" aria-hidden="true"><span class="octicon octicon-link"></span></a>The git2r package</h2>
<p>The <code class="language-plaintext highlighter-rouge">git2r</code> package is a popular R package which is mainly known for using git with R. It gives users programmatic experience with git using R. It is very fast because it implements git core methods developed with C. As the developers of the package improved and updated the package, they made a breaking transition. They made a change in support from S4 objects to S3 objects. A simple fix to this issue will be to pin the version of the package to specific versions in the <code class="language-plaintext highlighter-rouge">DESCRIPTION</code> file. However, a lot of developers have always install the latest versions of packages. As I tested <code class="language-plaintext highlighter-rouge">Rperform</code> for the first time, I had the issue. This is the error I had :</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span><span class="w"> </span><span class="n">plot_metrics</span><span class="p">(</span><span class="n">test_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"tests/testthat/test-join.r"</span><span class="p">,</span><span class="w"> </span><span class="n">metric</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"time"</span><span class="p">,</span><span class="w"> </span><span class="n">num_commits</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">save_data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">save_plots</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span><span class="w">
</span><span class="n">Error</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">base</span><span class="o">::</span><span class="n">substr</span><span class="p">(</span><span class="n">commit_val</span><span class="o">@</span><span class="n">summary</span><span class="p">,</span><span class="w"> </span><span class="n">start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">stop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">15</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> 
  </span><span class="n">trying</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">get</span><span class="w"> </span><span class="n">slot</span><span class="w"> </span><span class="s2">"summary"</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">object</span><span class="w"> </span><span class="p">(</span><span class="n">class</span><span class="w"> </span><span class="s2">"git_commit"</span><span class="p">)</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">S4</span><span class="w"> </span><span class="n">object</span><span class="w"> 
</span></code></pre></div></div>

<p>Analyzing the error message suggests that the program is trying to get a property from an object which is not S4 object but rather S3 object. 
The actual issue was that my <code class="language-plaintext highlighter-rouge">git2r</code> version was the latest version. For some reason, the package version which should have been pinned to be <code class="language-plaintext highlighter-rouge">&lt;= version 0.21.0</code> was ignored by my program. The fact is that, the latest <code class="language-plaintext highlighter-rouge">git2r</code> package has a lot of new features and fixes. The first task I had to do was updating Rperform to also support the newer versions of <code class="language-plaintext highlighter-rouge">git2r</code> so as to make it easier for other developers to use and test the package. I updated the <code class="language-plaintext highlighter-rouge">git2r</code> version to <code class="language-plaintext highlighter-rouge">(&gt;= 0.30.1)</code> in the <code class="language-plaintext highlighter-rouge">DESCRIPTION</code> file so it made some functions in the code obsolete. First of all, the names of some functions were updated. Refactoring the code was not difficult but running through the documentation of the <code class="language-plaintext highlighter-rouge">git2r</code> package and checking the newer functions proved to be a little challenging and time consuming. 
First major change I had to make was replace the <code class="language-plaintext highlighter-rouge">head</code> function to <code class="language-plaintext highlighter-rouge">repository_head</code> function. This function basically gets the <code class="language-plaintext highlighter-rouge">HEAD</code> of a repository.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># From</span><span class="w">
</span><span class="o">&gt;</span><span class="w"> </span><span class="n">repo_head</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">git2r</span><span class="o">::</span><span class="n">head</span><span class="p">(</span><span class="n">repo</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>
<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># To</span><span class="w">
</span><span class="o">&gt;</span><span class="w"> </span><span class="n">repo_head</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">git2r</span><span class="o">::</span><span class="n">repository_head</span><span class="p">(</span><span class="n">repo</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>Also, I had to check all the functions related to the issue to be compatible to S3 objects. Just to name a few, some of them are :</p>
<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># From</span><span class="w">
</span><span class="o">&gt;</span><span class="w"> </span><span class="n">base</span><span class="o">::</span><span class="n">substr</span><span class="p">(</span><span class="n">commit_val</span><span class="o">@</span><span class="n">summary</span><span class="p">,</span><span class="w"> </span><span class="n">start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">stop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">15</span><span class="p">)</span><span class="w">
</span><span class="o">&gt;</span><span class="w"> </span><span class="n">repo_head</span><span class="o">@</span><span class="n">name</span><span class="w">
</span></code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># To</span><span class="w">
</span><span class="o">&gt;</span><span class="w"> </span><span class="n">base</span><span class="o">::</span><span class="n">substr</span><span class="p">(</span><span class="n">commit_val</span><span class="o">$</span><span class="n">summary</span><span class="p">,</span><span class="w"> </span><span class="n">start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">stop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">15</span><span class="p">)</span><span class="w">
</span><span class="o">&gt;</span><span class="w"> </span><span class="n">repo_head</span><span class="o">$</span><span class="n">name</span><span class="w">
</span></code></pre></div></div>
<p>Initially, I used numeric indexes to reference list members. I switched to using named reference approach to reference list members by names instead of numeric indexes because it was less error prone. With most of the changes just like above examples, I just had to replace the <code class="language-plaintext highlighter-rouge">@</code> symbol with the <code class="language-plaintext highlighter-rouge">$</code> symbol. Others were a little more complex than that.</p>

<h2 id="the-animint-dependency">
<a class="anchor" href="#the-animint-dependency" aria-hidden="true"><span class="octicon octicon-link"></span></a>The Animint dependency</h2>
<p>The <a href="https://github.com/tdhock/animint">animint</a> package is a forked version of the <code class="language-plaintext highlighter-rouge">ggplot2</code> with improved features. It enables developers to design multi-plot, multi-layer, interactive and animated data visualizations. Unfortunately, the original version has been discontinued. Even though, it was an optional package in the root <code class="language-plaintext highlighter-rouge">DESCRIPTION</code> file, it was worth looking into. However, my attention only drew to it when I was running a <code class="language-plaintext highlighter-rouge">CMD R Check</code> on the <code class="language-plaintext highlighter-rouge">Rperform</code> package and it failed. The Github CI test showed that it is not possible to install it because it could not recognize the package. After digging into the issue, I realized the package has been discontinued. Fast forward, there is an updated version called the <a href="https://github.com/tdhock/animint2">animint2</a> which comes with easier installation and better syntax. Therefore I updated the package to <code class="language-plaintext highlighter-rouge">animint2</code> in the <code class="language-plaintext highlighter-rouge">DESCRIPTION</code> file. Then, I checked and tested all the functions that depend on the animint2 package. Most of them had to do with just replacing <code class="language-plaintext highlighter-rouge">animint</code> with <code class="language-plaintext highlighter-rouge">animint2</code>.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># From</span><span class="w">
</span><span class="o">&gt;</span><span class="w"> </span><span class="n">animint</span><span class="o">::</span><span class="n">theme_animint</span><span class="p">(</span><span class="n">height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">700</span><span class="p">)</span><span class="w">
</span><span class="o">&gt;</span><span class="w"> </span><span class="n">animint</span><span class="o">::</span><span class="n">animint2dir</span><span class="p">(</span><span class="n">plot.list</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">viz.list</span><span class="p">,</span><span class="w"> </span><span class="n">out.dir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">paste0</span><span class="p">(</span><span class="n">basename</span><span class="p">(</span><span class="n">getwd</span><span class="p">()),</span><span class="w"> </span><span class="s2">"_"</span><span class="p">,</span><span class="w"> </span><span class="s2">"time_animint"</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># To</span><span class="w">
</span><span class="o">&gt;</span><span class="w"> </span><span class="n">animint2</span><span class="o">::</span><span class="n">theme_animint</span><span class="p">(</span><span class="n">height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">700</span><span class="p">)</span><span class="w">
</span><span class="o">&gt;</span><span class="w"> </span><span class="n">animint2</span><span class="o">::</span><span class="n">animint2dir</span><span class="p">(</span><span class="n">plot.list</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">viz.list</span><span class="p">,</span><span class="w"> </span><span class="n">out.dir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">paste0</span><span class="p">(</span><span class="n">basename</span><span class="p">(</span><span class="n">getwd</span><span class="p">()),</span><span class="w"> </span><span class="s2">"_"</span><span class="p">,</span><span class="w"> </span><span class="s2">"time_animint"</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<h2 id="fix-dependency-and-related-issues">
<a class="anchor" href="#fix-dependency-and-related-issues" aria-hidden="true"><span class="octicon octicon-link"></span></a>Fix dependency and related issues</h2>
<p>After all the changes and updates, I opened a Pull Request to address the issues. <a href="https://github.com/EngineerDanny/Rperform/pull/2">PR#2</a> and
<a href="https://github.com/EngineerDanny/Rperform/pull/3">PR#3</a>. As it was a pending issue raised twice on the main repository. These combined <a href="https://github.com/analyticalmonk/Rperform/pull/47">PRs</a> close issues <a href="https://github.com/analyticalmonk/Rperform/issues/44">#44</a> and <a href="https://github.com/analyticalmonk/Rperform/issues/45">#45</a>.</p>

<h1 id="conclusion">
<a class="anchor" href="#conclusion" aria-hidden="true"><span class="octicon octicon-link"></span></a>Conclusion</h1>
<p>I have realized that the dependencies that our projects utilize are very crucial to the development of the package and its users. At first, I nearly gave up on the <code class="language-plaintext highlighter-rouge">Rperform</code> package because of it’s support for old dependencies which were not already installed and for some reason could not get installed  on my computer. Updating dependencies ensures the package gets access to the latest features, improvements and bug fixes. Downgrading the <code class="language-plaintext highlighter-rouge">git2r</code> dependency was a temporal fix, updating and ensuring that all related issues are fixed became the permanent fix.</p>

  </div><a class="u-url" href="/GSOC22-RPerform-Blog/rperform/performance/test/r/git/github/2022/06/20/Updating-dependencies-In-Rperform.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/GSOC22-RPerform-Blog/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/GSOC22-RPerform-Blog/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/GSOC22-RPerform-Blog/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>A blogging platform to track my progress in GSOC 2022 | RPerform.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/EngineerDanny" target="_blank" title="EngineerDanny"><svg class="svg-icon grey"><use xlink:href="/GSOC22-RPerform-Blog/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://www.linkedin.com/in/engineerdanny" target="_blank" title="engineerdanny"><svg class="svg-icon grey"><use xlink:href="/GSOC22-RPerform-Blog/assets/minima-social-icons.svg#linkedin"></use></svg></a></li><li><a rel="me" href="https://twitter.com/EngineerDevDan" target="_blank" title="EngineerDevDan"><svg class="svg-icon grey"><use xlink:href="/GSOC22-RPerform-Blog/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
